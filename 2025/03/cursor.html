<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>全网首家，教你快速打造个人/企业版本 cursor | 混沌随想</title>
    <meta
      name="keywords"
      content="全网首家，教你快速打造个人/企业版本 cursor | 混沌随想,专注 web 前端技术和通用软件架构,独立思考的软件工程师,研发效能,代码整洁,vscode,javascript,rust"
    />
    <!-- 这个是对 www  的校验，后面不需要了， www 重定向到不带 www --> 
    <meta name="baidu-site-verification" content="code-4W4K0O9eo0" />
    <meta name="google-site-verification" content="9eboClR0-Z_Vev1mKebNKCT5T2x97YNwB5n19DNao28" />
    <!-- 不带 www --> 
    <meta name="baidu-site-verification" content="code-x9cZsWaFIx" />
    <meta name="generator" content="VuePress 1.9.7" />
     <meta name="description" content="全网首家，教你快速打造个人/企业版本 cursor">  <link rel="preload" href="/assets/css/0.styles.0dc98de6.css" as="style"><link rel="preload" href="/assets/js/app.32403bab.js" as="script"><link rel="preload" href="/assets/js/3.8dc51a7a.js" as="script"><link rel="prefetch" href="/assets/js/10.51147c62.js"><link rel="prefetch" href="/assets/js/100.b1492abc.js"><link rel="prefetch" href="/assets/js/101.e82c4447.js"><link rel="prefetch" href="/assets/js/102.0a584c97.js"><link rel="prefetch" href="/assets/js/103.175877ad.js"><link rel="prefetch" href="/assets/js/11.fdb2f0cc.js"><link rel="prefetch" href="/assets/js/12.0a30ed29.js"><link rel="prefetch" href="/assets/js/13.f69e82b2.js"><link rel="prefetch" href="/assets/js/14.4e4885bc.js"><link rel="prefetch" href="/assets/js/15.d027296f.js"><link rel="prefetch" href="/assets/js/16.38f3b7aa.js"><link rel="prefetch" href="/assets/js/17.5f0cd1ef.js"><link rel="prefetch" href="/assets/js/18.72085d04.js"><link rel="prefetch" href="/assets/js/19.a835b78a.js"><link rel="prefetch" href="/assets/js/20.c771a601.js"><link rel="prefetch" href="/assets/js/21.8070a6a4.js"><link rel="prefetch" href="/assets/js/22.f22f0ee9.js"><link rel="prefetch" href="/assets/js/23.d2827f1e.js"><link rel="prefetch" href="/assets/js/24.b5dbeb2f.js"><link rel="prefetch" href="/assets/js/25.affcd6a6.js"><link rel="prefetch" href="/assets/js/26.d5d5dc29.js"><link rel="prefetch" href="/assets/js/27.fa3f3c2a.js"><link rel="prefetch" href="/assets/js/28.2cd321b3.js"><link rel="prefetch" href="/assets/js/29.e1c6d3dc.js"><link rel="prefetch" href="/assets/js/30.57138dca.js"><link rel="prefetch" href="/assets/js/31.84c0c338.js"><link rel="prefetch" href="/assets/js/32.fdc19c9e.js"><link rel="prefetch" href="/assets/js/33.3dfb865a.js"><link rel="prefetch" href="/assets/js/34.33abc3eb.js"><link rel="prefetch" href="/assets/js/35.f4f9dfee.js"><link rel="prefetch" href="/assets/js/36.52cf06ae.js"><link rel="prefetch" href="/assets/js/37.394472e1.js"><link rel="prefetch" href="/assets/js/38.d9311661.js"><link rel="prefetch" href="/assets/js/39.bb1e3134.js"><link rel="prefetch" href="/assets/js/4.8d6e4007.js"><link rel="prefetch" href="/assets/js/40.f5390aba.js"><link rel="prefetch" href="/assets/js/41.ebe29e43.js"><link rel="prefetch" href="/assets/js/42.1fccbe7a.js"><link rel="prefetch" href="/assets/js/43.28e14c5f.js"><link rel="prefetch" href="/assets/js/44.ee7f7ee0.js"><link rel="prefetch" href="/assets/js/45.58bdca2a.js"><link rel="prefetch" href="/assets/js/46.bccd73d4.js"><link rel="prefetch" href="/assets/js/47.0241f1e0.js"><link rel="prefetch" href="/assets/js/48.8d645d97.js"><link rel="prefetch" href="/assets/js/49.aca5f8fc.js"><link rel="prefetch" href="/assets/js/5.7f3f9f22.js"><link rel="prefetch" href="/assets/js/50.b67ec2dd.js"><link rel="prefetch" href="/assets/js/51.9b0117bd.js"><link rel="prefetch" href="/assets/js/52.ec3e1e4c.js"><link rel="prefetch" href="/assets/js/53.fc157c97.js"><link rel="prefetch" href="/assets/js/54.479c0197.js"><link rel="prefetch" href="/assets/js/55.3ac12af8.js"><link rel="prefetch" href="/assets/js/56.cecd7a4a.js"><link rel="prefetch" href="/assets/js/57.8bf80825.js"><link rel="prefetch" href="/assets/js/58.7b86775f.js"><link rel="prefetch" href="/assets/js/59.37078ed4.js"><link rel="prefetch" href="/assets/js/6.8ea32bd8.js"><link rel="prefetch" href="/assets/js/60.ed7ec107.js"><link rel="prefetch" href="/assets/js/61.8b1a595d.js"><link rel="prefetch" href="/assets/js/62.5cab2281.js"><link rel="prefetch" href="/assets/js/63.e3da29c8.js"><link rel="prefetch" href="/assets/js/64.fbd43d88.js"><link rel="prefetch" href="/assets/js/65.33b8c5db.js"><link rel="prefetch" href="/assets/js/66.f50e25d9.js"><link rel="prefetch" href="/assets/js/67.70c8f281.js"><link rel="prefetch" href="/assets/js/68.23f66319.js"><link rel="prefetch" href="/assets/js/69.1f1d799d.js"><link rel="prefetch" href="/assets/js/7.ecca50fc.js"><link rel="prefetch" href="/assets/js/70.a055c951.js"><link rel="prefetch" href="/assets/js/71.a9e657da.js"><link rel="prefetch" href="/assets/js/72.cd9b577a.js"><link rel="prefetch" href="/assets/js/73.c25c793c.js"><link rel="prefetch" href="/assets/js/74.61b6bc43.js"><link rel="prefetch" href="/assets/js/75.9957780c.js"><link rel="prefetch" href="/assets/js/76.ea128704.js"><link rel="prefetch" href="/assets/js/77.eb17d0a8.js"><link rel="prefetch" href="/assets/js/78.8eb43e7a.js"><link rel="prefetch" href="/assets/js/79.f0cdc7a5.js"><link rel="prefetch" href="/assets/js/8.d2bddb8a.js"><link rel="prefetch" href="/assets/js/80.a30cce84.js"><link rel="prefetch" href="/assets/js/81.4c8fe987.js"><link rel="prefetch" href="/assets/js/82.06c14436.js"><link rel="prefetch" href="/assets/js/83.294c9208.js"><link rel="prefetch" href="/assets/js/84.a57c16c4.js"><link rel="prefetch" href="/assets/js/85.281aa58a.js"><link rel="prefetch" href="/assets/js/86.97f202f0.js"><link rel="prefetch" href="/assets/js/87.af0c8754.js"><link rel="prefetch" href="/assets/js/88.0355a3cb.js"><link rel="prefetch" href="/assets/js/89.bcd768a3.js"><link rel="prefetch" href="/assets/js/9.fd658507.js"><link rel="prefetch" href="/assets/js/90.2a93c57c.js"><link rel="prefetch" href="/assets/js/91.b3126e8f.js"><link rel="prefetch" href="/assets/js/92.9f9ae6c4.js"><link rel="prefetch" href="/assets/js/93.458e4b06.js"><link rel="prefetch" href="/assets/js/94.e9789412.js"><link rel="prefetch" href="/assets/js/95.0d359a3b.js"><link rel="prefetch" href="/assets/js/96.8beb4bad.js"><link rel="prefetch" href="/assets/js/97.dccf438a.js"><link rel="prefetch" href="/assets/js/98.c52a218f.js"><link rel="prefetch" href="/assets/js/99.5ab798af.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.a7c5c6f6.js"> <link rel="stylesheet" href="/assets/css/0.styles.0dc98de6.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="混沌随想" class="logo"> <span class="site-name can-hide">混沌随想</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于作者</a></div> <!----></nav> <a href="/settings/" title="博客设置" class="settings-link">
      ⚙️
    </a></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于作者</a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>全网首家，教你快速打造个人/企业版本 cursor</span> <!----></p> <ul class="sidebar-group-items"></ul></div></li></ul> </div> <div data-v-d56170a2><div class="blog" data-v-d56170a2><div class="blog__header" data-v-d56170a2><p class="publish-date" data-v-d56170a2><time datetime="2025-03-09T11:28:00.000Z" data-v-d56170a2>2025年3月9日</time></p> <!----> <h1 class="blog__title" data-v-d56170a2>全网首家，教你快速打造个人/企业版本 cursor</h1></div> <div class="wechat-content html-isolated" data-v-d56170a2>
<p  style="margin: 0px 0px 1.4em; visibility: visible;"><span leaf="" style="visibility: visible;">笔者长期在 cursor / windsurf 之间徘徊，多次切换 GitHub Copilot 发现都没有达到很好的效果。</span></p><p style="margin: 1.4em 0px; visibility: visible;"><span leaf="" style="visibility: visible;">这里主要有几个重要的能力差距：1. Copilot 代码智能、且快速的自动应用。 2. Agent 自动编程模式。3. UI/UX交互体验细节</span></p><p style="margin: 1.4em 0px; visibility: visible;"><span leaf="" style="visibility: visible;">前面两个功能的实现，从原理上并不复杂，但提示</span><b style="font-weight: 600; visibility: visible;"><span leaf="" style="visibility: visible;">工程细节优化非常需要耐心</span></b><span leaf="" style="visibility: visible;">。Copilot 团队在文档中也介绍了这里的工作量。</span></p><p style="visibility: visible;"><span leaf="" style="visibility: visible;"><img data-src="/assets/images/wechat/mmbiz_qpic_cn_d4a225f7858d679e193d29b32df13c25.jpeg" class="rich_pages wxw-img"       src="/assets/images/wechat/mmbiz_qpic_cn_d4a225f7858d679e193d29b32df13c25.jpeg" _width="677px" style="height: auto !important; visibility: visible !important; width: 677px !important;" crossorigin="anonymous" alt="图片"  ></span></p><figure  style="margin: 1.4em 0px; visibility: visible;"><section nodeleaf="" style="visibility: visible;"><img data-src="/assets/images/wechat/mmbiz_qpic_cn_777492f6a7b4933c57d0b3cb2835fbc6.jpeg" class="rich_pages wxw-img"    height="724" style="display: none; margin: 0px auto; max-width: 100%; height: auto !important; background-color: rgb(255, 255, 255); cursor: zoom-in; animation: 0.5s ease-in 0s 1 normal none running animation-1yvu044; width: 690px !important; visibility: visible !important;" width="1666"    src="/assets/images/wechat/mmbiz_qpic_cn_777492f6a7b4933c57d0b3cb2835fbc6.jpeg" _width="677px" crossorigin="anonymous" alt="图片"  ></section></figure><p style="visibility: visible;"><span leaf="" style="visibility: visible;"><br style="visibility: visible;"></span></p><p style="margin: 1.4em 0px; visibility: visible;"><span leaf="" style="visibility: visible;">今天尝试了最新的 vscode insiders 预览版，直接基于 3.5 sonnet 体验 Agent 模式，跑出一个现实真实的任务，让其整个过程自主思考、行动、编码的流程非常丝滑，包括自动 Apply 代码的交互细节（光标滚动的 UI/UX 动画 比 sursor 还要棒），整体几乎与 cursor 趋同。</span></p><figure  style="margin: 1.4em 0px;"><span leaf=""><img data-src="/assets/images/wechat/mmbiz_qpic_cn_b220c530aab027196812a8b3d165d93a.jpeg" class="rich_pages wxw-img"       src="/assets/images/wechat/mmbiz_qpic_cn_b220c530aab027196812a8b3d165d93a.jpeg" _width="677px" style="height: auto !important; visibility: visible !important; width: 677px !important;" crossorigin="anonymous" alt="图片"  ></span><figcaption style="color: rgb(145, 150, 161);font-size: 0.9em;line-height: 1.5;margin-top: calc(0.666667em);padding: 0px 1em;text-align: center;"><span leaf="">如上是基于 3.5 sonnet 的 Agent 模式效果</span></figcaption></figure><p><span leaf=""><br></span></p><p style="margin: 1.4em 0px;"><span leaf="">虽然目前有 cursor sonnet 3.5/3.7 作为主力，但重度依赖海外的模型很容易在关键时刻受制于人（最近笔者的openai pro 被封了～～）, 加上公司最近禁用 cursor, 于是在想，能否让 vscode Copilot 走自己的指定的模型，比如 qwen/ deepseek 等系列。 为了避免“重复工作”， 首先用中英文，分别在网络，以及X 平台检索了下，得到的结论是：</span><b style="font-weight: 600;"><span leaf="">整个 Copilot 是封闭的，不提供任何用户模型可配，目前也无任何人进行这一适配工作，以实现用自己的模型替代。</span></b></p><p style="margin: 1.4em 0px;"><span leaf="">在简单研究（逆向）了下 vscode Copilot 后，我发现 vscode insiders 可以替换成 qwen 的模型，打造自己专属的 IDE了。</span></p><h2  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.2em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(2.33333em) 0px calc(1.16667em);clear: left;"><span leaf="">效果</span></h2><h2  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.2em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(2.33333em) 0px calc(1.16667em);clear: left;"><span leaf=""><img data-src="/assets/images/wechat/mmbiz_qpic_cn_0cb05320a9b46204cb1da93827185e52.jpeg" class="rich_pages wxw-img js_img_placeholder wx_img_placeholder"       src="/assets/images/wechat/mmbiz_qpic_cn_0cb05320a9b46204cb1da93827185e52.jpeg" _width="677px" style="width: 677px !important; height: 433.155px !important;" crossorigin="anonymous" alt="图片"></span></h2><figure  style="margin: 1.4em 0px;"></figure><p style="margin: 1.4em 0px;"><span leaf="">我们观察右下角，出现了一个 qwen-max。我们成功切换到 了 qwen 模型。并能调用工具启动 Agent 模式，同时自动 apply 应用和修改代码 (也是配的 qwen-max)。</span></p><p><span leaf=""><br></span></p><figure  style="margin: 1.4em 0px;"><figcaption style="color: rgb(145, 150, 161);font-size: 0.9em;line-height: 1.5;margin-top: calc(0.666667em);padding: 0px 1em;text-align: center;"><span leaf=""><img data-src="/assets/images/wechat/mmbiz_qpic_cn_f7422f1d320163f04cdb5a556c949886.jpeg" class="rich_pages wxw-img js_img_placeholder wx_img_placeholder"       src="/assets/images/wechat/mmbiz_qpic_cn_f7422f1d320163f04cdb5a556c949886.jpeg" _width="677px" style="width: 646.4px !important; height: 319.609px !important;" crossorigin="anonymous" alt="图片">获取LLM接口的关键断点</span></figcaption></figure><h2  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.2em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(2.33333em) 0px calc(1.16667em);clear: left;"><span leaf="">原理</span></h2><p style="margin: 1.4em 0px;"><span leaf="">简单介绍 Copilot Agent 的原理，但本文不会过多细节介绍，官方已经做了基本介绍&nbsp;</span><span leaf="">Introducing GitHub Copilot agent mode (preview)</span><span leaf="">。 实际上，目前的行业的实现的方案都大同小异，方向上归于 ACI （Agent-Computer Interface&nbsp;</span><span style="background-color: transparent;color: transparent;font: 0px / 0 a;text-shadow: none;"><span leaf="">https://</span></span><span leaf="">arxiv.org/abs/2405.1579</span><span style="background-color: transparent;color: transparent;font: 0px / 0 a;text-shadow: none;"><span leaf="">3</span></span><span leaf="">），差别在于细节。也可结合笔者之前的之前的一些技术</span><span leaf="">分享</span><span leaf="">等。</span></p><p style="margin: 1.4em 0px;"><span leaf=""><br></span></p><p style="margin: 1.4em 0px;"><span leaf=""><img data-src="/assets/images/wechat/mmbiz_qpic_cn_8ea7929de2c0388a02ddb2d442d0166a.jpeg" class="rich_pages wxw-img js_img_placeholder wx_img_placeholder"       src="/assets/images/wechat/mmbiz_qpic_cn_8ea7929de2c0388a02ddb2d442d0166a.jpeg" _width="677px" style="width: 677px !important; height: 327.844px !important;" crossorigin="anonymous" alt="图片"></span></p><figure  style="margin: 1.4em 0px;"></figure><p><span leaf=""><br></span></p><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">普通模式：</span></h3><p style="margin: 1.4em 0px;"><span leaf="">普通模式下的 Copilot 其实是简单的代码上下文 + chat，用户提出问题或需求，Copilot一次性生成回答或代码建议，不能主动执行操作或探索代码库。</span></p><p style="margin: 1.4em 0px;"><span leaf="">普通模式下， Copilot 会先让一个小模型 gpt4o-mini 做任务分类，</span></p><blockquote style="border-left: 3px solid rgb(196, 199, 206);color: rgb(83, 88, 97);margin: 1.4em 0px;padding-left: 1em;"><section><span leaf="">是一个有帮助的AI编程助手，为一位软件工程师用户服务，代表Visual Studio Code编辑器行动。你的任务是从下面的Markdown类别表中选择一个与用户问题匹配的类别。仔细审查用户的问题、任何之前的消息以及提供的上下文，如代码片段。只需回复类别名称。你选择的类别将帮助Visual Studio Code为用户提供更高质量的回应，选择错误将降低用户使用Visual Studio Code的体验，所以你必须明智选择。如果你无法选择仅一个类别，或者如果没有类别似乎能为用户提供更好的结果，你必须始终回复\"unknown\"。</span></section></blockquote><p style="margin: 1.4em 0px;"><span leaf="">Copilot 内置了集中任务分类，然后再返回，让更大的模型去完成，比如涉及到“用户想了解或更新当前工作区中的代码或文件“ ，返回 “workspace_project_questions“ ，这种类型则会自动调用 codebase 模块进行向量化全局检索。</span></p><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">Edit 模式：</span></h3><p style="margin: 1.4em 0px;"><span leaf="">在普通模式的基础上，添加自动编辑的能力，会调用 edit_file ，把代码片段智能插入到代码中，完成编辑。</span></p><p style="margin: 1.4em 0px;"><span leaf="">提示词示例</span></p><section style="white-space: pre-wrap;margin: 0px;overflow-wrap: initial;background: rgb(248, 248, 250);border-radius: 4px;font-size: 0.9em;overflow: auto;padding: calc(0.888889em);word-break: initial;"><span leaf="" style="white-space: pre-wrap;overflow-wrap: initial;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;overflow: auto;word-break: initial;background-color: inherit;border-radius: 0px;font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size: inherit;margin: 0px;padding: 0px;">你是一个具有专家级知识的高度复杂的自动化编码代理，精通多种不同的编程语言和框架。用户会提出问题或要求你执行任务，可能需要大量研究才能正确回答。有一系列工具可以让你执行操作或获取有用的上下文来回答用户的问题。如果你能从用户的查询或你拥有的上下文中推断出项目类型（语言、框架和库），请在进行更改时牢记这些信息。如果用户希望你实现一个功能，但没有指定要编辑的文件，首先将用户的请求分解为更小的概念，并思考你需要理解每个概念所需的文件类型。如果你不确定哪个工具相关，可以调用多个工具。你可以重复调用工具来执行操作或收集尽可能多的上下文，直到你完全完成任务。除非你确定无法用你拥有的工具完成请求，否则不要放弃。确保你已尽一切努力收集必要的上下文是你的责任。除非你知道确切的字符串或文件名模式，否则优先使用semantic_search工具搜索上下文。不要对情况做假设 - 首先收集上下文，然后执行任务或回答问题。创造性思考并探索工作空间，以做出完整的修复。工具调用后不要重复自己，从你离开的地方继续。除非用户要求，否则永远不要打印出带有文件更改的代码块。请使用edit_file工具。除非用户要求，否则永远不要打印出带有要运行的终端命令的代码块。请使用run_in_terminal工具。如果上下文中已提供文件，则不需要读取该文件。</span></section><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">Agent 模式：</span></h3><p style="margin: 1.4em 0px;"><span leaf="">具有主动性和自主决策能力，可以使用多种工具探索和理解代码库，能够执行实际操作（读取文件、运行命令、编辑代码等），消耗更多 token。一会我们重点看这里。</span></p><p style="margin: 1.4em 0px;"><span leaf="">Agent模式下，Copilot可以使用多种工具：</span></p><ul style="list-style: none;margin: 1.4em 0px;padding: 0px;width: 690px;" class="list-paddingleft-1"><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">semantic_search：自然语言搜索相关代码或文档</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">list_code_usages：列出函数、类、方法等的所有使用情况</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">file_search：通过glob模式搜索文件</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">grep_search：在工作区中进行文本搜索</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">read_file：读取文件内容</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">list_dir：列出目录内容</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">run_in_terminal：在终端中运行shell命令</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">get_terminal_output：获取终端命令的输出</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">get_errors：获取代码文件中的编译或lint错误</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">get_changed_files：获取当前git仓库中的文件更改</span></section></li><li style="list-style: none;display: table;width: 690px;"><section><span leaf="">edit_file：编辑工作区中的文件</span></section></li></ul><p style="margin: 1.4em 0px;"><span leaf="">这是一种标准的 ACI操作(Agent-Computer Interface)，和笔者自己实现过的一些 Agent 工具类似， 其本质就是一个 Loop 循环自迭代调用工具，直到完成任务，里面的策略细节由提示工程驱动。但 Copilot 提示词中特别强调，优先使用 semantic_search 工具。</span></p><blockquote style="border-left: 3px solid rgb(196, 199, 206);color: rgb(83, 88, 97);margin: 1.4em 0px;padding-left: 1em;"><section><span leaf="">Prefer using the semantic_search tool to search for context unless you know the exact string or filename pattern you're searching for</span></section></blockquote><p style="margin: 1.4em 0px;"><span leaf="">这是一种挺好的策略，大多情况下，向量化检索，能初步从广泛的代码空间筛选出相关性高的，随后再调用其他工具深入研究。</span></p><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">智能 apply 应用</span></h3><p style="margin: 1.4em 0px;"><span leaf="">这个功能可谓是 cursor 独领风骚一段时间的关键之一。最初，大多数智能 ide 由大模型生成代码，但却需要人手工插入到指定行，实际这个过程是很费心智的事情，特别是涉及一些长代码片段。智能应用则是 AI 替代了人，把代码片段插入到合适的文件。原理也是基于 LLM 做输出，目前看 github Copilot 底层实现较为粗糙，使用了一个特别的模型，重写整个文件，应用的时间较久。 提示词如下(翻译版)：</span></p><pre style="white-space:pre-wrap;margin: 0px;overflow-wrap: initial;background: rgb(248, 248, 250);border-radius: 4px;font-size: 0.9em;overflow: auto;padding: calc(0.888889em);word-break: initial;"><code style="background-color: inherit;border-radius: 0px;font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size: inherit;margin: 0px;padding: 0px;"><span leaf="" style="white-space: pre-wrap;overflow-wrap: initial;background-image: initial;background-position: initial;background-size: initial;background-repeat: initial;background-attachment: initial;background-origin: initial;background-clip: initial;overflow: auto;word-break: initial;background-color: inherit;border-radius: 0px;font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size: inherit;margin: 0px;padding: 0px;">你是一个专门应用于现有文档代码更改的AI编程助手。\n遵循微软内容政策。\n避免侵犯版权的内容。\n如果被要求生成有害、仇恨、种族主义、性别歧视、淫秽、</span><span leaf="">暴力或与软件工程完全无关的内容，仅回复“抱歉，我无法协助。”\n保持回答简短且不带个人色彩。\n用户有一个代表代码更改建议的代码块和一个在代码编辑器中打开的Python文件。\n重写现有文档以完全整合提供的代码块中的更改。\n对于响应，始终遵循以下说明：\n1. 分析代码块和现有文档，决定是替换现有代码还是插入新代码。\n2. 如有必要，将代码块拆分为多个部分并在适当位置插入每个部分。\n3. 保留修改后部分的空白和新行。\n4. 最终结果必须在语法上有效、格式正确且缩进无误，不应包含任何...现有代码...... more ...</span></code></pre><p style="margin: 1.4em 0px;"><span leaf="">这个 appy 的模型，理论上是一个参数较小，但特别微调，专用于将代码片段应用的模型。cursor 负责人在采访中，也是提到使用了专门优化的 diff 对修改模型，并且结合了大模型基础上，再做了大量效率优化。</span></p><p style="margin: 1.4em 0px;"><span leaf="">apply 是 Agent 自动化的关键 ，因为</span><b style="font-weight: 600;"><span leaf="">它保证了Agent 能正确的把代码片段写入文件。</span></b></p><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">Copilot &amp; vscode</span></h3><p style="margin: 1.4em 0px;"><span leaf="">github Copilot 在设计上本身不属于 vscode 内核的一部分，但其主体的大模型 Chat 聊天 UI/UX 、服务等基础逻辑在vscode contrib/chat 模块下，属于开源的基础设施。但开源版本核心不包括提示词工程，Agent 策略，模型请求 等 Copilot 逻辑。 我们上面提到的这些提示词等，都是在 github Copilot chat 这个插件中，插件是以压缩和非开源的形式发布。</span></p><p style="margin: 1.4em 0px;"><span leaf="">如上提到的 3 种 Copilot 策略，</span><b style="font-weight: 600;"><span leaf="">都是属于微软官方私有“业务层”，配置在插件中，以插件的形式发布和加载，</span></b><span leaf="">并需要登录 github 账户才能使用。</span></p><p style="margin: 1.4em 0px;"><span leaf="">能理解微软的这种方案和架构，在未来的智能 IDE中，Chat UI 交互（聊天界面、发消息等）等已经是编辑器不可缺失的功能，没有必要让大家重复造轮子。但背后的模型，以及模型的提示工程策略则属于私有策略，这部分可以成为“增值产品”，这也是 github Copilot 付费收入的来源。</span></p><p style="margin: 1.4em 0px;"><span leaf="">未来应该会有更多的第三方 Copilot 开源插件实现，并重新， 替代微软自己的模型策略。</span></p><h2  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.2em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(2.33333em) 0px calc(1.16667em);clear: left;"><span leaf="">替换成个人模型</span></h2><p style="margin: 1.4em 0px;"><span leaf="">简单了解上面的原理后，接下来，我们尝试能否快速在 LLM 接口层用 qwen 替代内置模型。 先配置 https 代理，用于拦截 vscode 的请求。</span></p><p><span leaf=""><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder"   data-src="/assets/images/wechat/mmbiz_qpic_cn_225d66746ec31845ef0c3a90c3f93b42.jpeg"     src="/assets/images/wechat/mmbiz_qpic_cn_225d66746ec31845ef0c3a90c3f93b42.jpeg" _width="677px" style="width: 677px !important; height: 113.46px !important;" crossorigin="anonymous" alt="图片"></span></p><p><span leaf=""><br></span></p><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">拦截模型列表</span></h3><p style="margin: 1.4em 0px;"><span leaf="">Copilot 能选择的模型由这个接口返回：&nbsp;</span><span leaf="">https://api.individual.githubcopilot.com/models</span></p><p style="margin: 1.4em 0px;"><span leaf="">我们在代理层拦截并mock 这个接口，在第一行添加 qwen-max ，启用工具调用，可把下的的 json 直接复制到 mock 的接口。（文本使用的是 whistle ）</span></p><pre style="white-space:pre-wrap;margin: 0px;overflow-wrap: initial;background: rgb(248, 248, 250);border-radius: 4px;font-size: 0.9em;overflow: auto;padding: calc(0.888889em);word-break: initial;"><code style="background-color: inherit;border-radius: 0px;font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size: inherit;margin: 0px;padding: 0px;"><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"data"</span></span><span leaf="">:</span><span leaf="">[</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"capabilities"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"family"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"qwen-max"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"limits"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_context_window_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">128000</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_output_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">4096</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_prompt_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">128000</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model_capabilities"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"supports"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"parallel_tool_calls"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"streaming"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"tool_calls"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"tokenizer"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"o200k_base"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"type"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"chat"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"id"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"qwen-max-latest"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"model_picker_enabled"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"name"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Qwen Max"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"preview"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">false</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"vendor"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Alibaba Cloud"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"version"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"qwen-max-latest"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="color: rgb(217, 83, 80);"><span leaf="">...</span></span><span style="color: rgb(217, 83, 80);"><span leaf="">more...</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"capabilities"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"family"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"text-embedding-3-small"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model_capabilities"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"supports"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"dimensions"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"tokenizer"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"cl100k_base"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"type"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"embeddings"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"id"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"text-embedding-3-small-inference"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"model_picker_enabled"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">false</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"name"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Embedding V3 small (Inference)"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"preview"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">false</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"vendor"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Azure OpenAI"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"version"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"text-embedding-3-small"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"capabilities"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"family"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"o3-mini"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"limits"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_context_window_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">200000</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_output_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">100000</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_prompt_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">64000</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model_capabilities"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"supports"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"streaming"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"structured_outputs"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"tool_calls"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"tokenizer"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"o200k_base"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"type"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"chat"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"id"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"o3-mini"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"model_picker_enabled"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"name"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"o3-mini (Preview)"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"preview"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"vendor"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Azure OpenAI"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"version"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"o3-mini-2025-01-31"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"capabilities"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"family"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"claude-3.5-sonnet"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"limits"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_context_window_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">90000</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_output_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">8192</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_prompt_tokens"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">90000</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"vision"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_prompt_image_size"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">3145728</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"max_prompt_images"</span></span><span leaf="">:</span><span style="color: rgb(23, 114, 246);"><span leaf="">1</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"supported_media_types"</span></span><span leaf="">:</span><span leaf="">[</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(217, 83, 80);"><span leaf="">"image/jpeg"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(217, 83, 80);"><span leaf="">"image/png"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(217, 83, 80);"><span leaf="">"image/gif"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(217, 83, 80);"><span leaf="">"image/webp"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">]</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">}</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model_capabilities"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"supports"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"parallel_tool_calls"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"streaming"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"tool_calls"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"tokenizer"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"o200k_base"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"type"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"chat"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"id"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"claude-3.5-sonnet"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"model_picker_enabled"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"name"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Claude 3.5 Sonnet (Preview)"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"model"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"policy"</span></span><span leaf="">:</span><span leaf="">{</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"state"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"enabled"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"terms"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Enable access to the latest Claude 3.5 Sonnet model from Anthropic. [Learn more about how GitHub Copilot serves Claude 3.5 Sonnet](https://docs.github.com/copilot/using-github-copilot/using-claude-sonnet-in-github-copilot)."</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">},</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"preview"</span></span><span leaf="">:</span><span style="font-weight: 600;"><span leaf="">true</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"vendor"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"Anthropic"</span></span><span leaf="">,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"version"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"claude-3.5-sonnet"</span></span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span leaf="">}</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf="">],</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span style="color: rgb(9, 64, 142);"><span leaf="">"object"</span></span><span leaf="">:</span><span style="color: rgb(217, 83, 80);"><span leaf="">"list"</span></span><span leaf=""><br></span><span leaf="">}</span></code></pre><figure  style="margin: 1.4em 0px;color: rgb(25, 27, 31);font-family: -apple-system, &quot;system-ui&quot;, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: medium;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: start;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;white-space: normal;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;"></figure><p style="margin: 1.4em 0px;"><span leaf=""><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder"   data-src="/assets/images/wechat/mmbiz_qpic_cn_38f61a849bcd47278580015a8eb83eb6.jpeg"     src="/assets/images/wechat/mmbiz_qpic_cn_38f61a849bcd47278580015a8eb83eb6.jpeg" _width="552px" style="width: 552px !important; height: 364px !important;" crossorigin="anonymous" alt="图片"></span></p><p style="margin: 1.4em 0px;"><span leaf="">如上，重启 vscode 我们就能看到新增加的模型了。</span></p><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">模型请求</span></h3><p style="margin: 1.4em 0px;"><span leaf="">上面全部列表的模型 ，Copilot 都使用&nbsp;</span><span leaf="">https://api.individual.githubcopilot.com/chat/completions</span><span leaf="">&nbsp;这个接口请求。</span></p><p style="margin: 1.4em 0px;"><span leaf="">接口的参数，竟然是标准的 openai 类的格式，意味着我们之间使用 qwen 的oepnai 兼容接口即可。</span></p><pre style="white-space:pre-wrap;margin: 0px;overflow-wrap: initial;background: rgb(248, 248, 250);border-radius: 4px;font-size: 0.9em;overflow: auto;padding: calc(0.888889em);word-break: initial;"><code style="background-color: inherit;border-radius: 0px;font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size: inherit;margin: 0px;padding: 0px;"><span leaf="">https://api.individual.githubcopilot.com/chat/completions https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions reqHeaders://{test-reqHeaders.json} reqReplace://{test-reqReplace.json}</span></code></pre><p style="margin: 1.4em 0px;"><span leaf="">我们把&nbsp;</span><span style="background-color: transparent;color: transparent;font: 0px / 0 a;text-shadow: none;"><span leaf="">http://</span></span><span leaf="">api.individual.githubcopilot.com</span><span style="background-color: transparent;color: transparent;font: 0px / 0 a;text-shadow: none;"></span><span leaf="">&nbsp;指向&nbsp;</span><span style="background-color: transparent;color: transparent;font: 0px / 0 a;text-shadow: none;"><span leaf="">http://</span></span><span leaf="">dashscope.aliyuncs.com</span><span style="background-color: transparent;color: transparent;font: 0px / 0 a;text-shadow: none;"></span><span leaf="">&nbsp;，并重写 api_key 为你自己阿里云的 key。</span></p><p style="margin: 1.4em 0px;"><span leaf="">此时，不需要重启，直接测试<img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder"   data-src="/assets/images/wechat/mmbiz_qpic_cn_664ca5a99e5854a55448bd37f4212add.jpeg"     src="/assets/images/wechat/mmbiz_qpic_cn_664ca5a99e5854a55448bd37f4212add.jpeg" _width="677px" style="width: 677px !important; height: 174.265px !important;" crossorigin="anonymous" alt="图片"></span></p><figure  style="margin: 1.4em 0px;"></figure><p style="margin: 1.4em 0px;"><span leaf="">能正常发起聊天，已经是 qwen-max 返回的内容了。</span></p><h3  style="font-style: inherit;font-variant: inherit;font-weight: 600;font-stretch: inherit;font-size: 1.1em;line-height: 1.5;font-family: inherit;font-optical-sizing: inherit;font-size-adjust: inherit;font-kerning: inherit;font-feature-settings: inherit;font-variation-settings: inherit;margin: calc(1.90909em) 0px calc(1.27273em);clear: left;"><span leaf="">智能 apply</span></h3><p style="margin: 1.4em 0px;"><span leaf="">前面提到过，Agent 正确的修改必须依赖 apply，所以我们还需要找到这个接口。</span></p><p style="margin: 1.4em 0px;"><span leaf="">https://proxy.individual.githubcopilot.com/v1/engines/copilot-centralus-h100/speculation</span></p><p style="margin: 1.4em 0px;"><span leaf="">这个接口请求一个专用的模型，用于修改文件。我们简单替换成 qwen-max。</span></p><p style="margin: 1.4em 0px;"><span leaf="">但这里还需要一点点额外工作，apply 模型和标准的 openai 接口不太兼容，需要简单的转化下格式。</span></p><pre style="white-space:pre-wrap;margin: 0px;overflow-wrap: initial;background: rgb(248, 248, 250);border-radius: 4px;font-size: 0.9em;overflow: auto;padding: calc(0.888889em);word-break: initial;color: rgb(25, 27, 31);font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: start;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;"><code style="background-color: inherit;border-radius: 0px;font-family: Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;lucida console&quot;, &quot;Courier New&quot;, monospace;font-size: inherit;margin: 0px;padding: 0px;"><span leaf="">&nbsp; &nbsp; let requestBody = req.body;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; if (typeof requestBody === 'string') {</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; try {</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; requestBody = JSON.parse(requestBody);</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; } catch (e) {</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; console.error('解析请求体失败:', e);</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; return res.status(400).send('无效的 JSON 格式');</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; }</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; }</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; // 提取提示词</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; if (!requestBody || !requestBody.prompt) {</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; console.error('请求体中没有 prompt 字段');</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; return res.status(400).send('请求缺少 prompt 字段');</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; }</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; const prompt = requestBody.prompt;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; // 解析系统提示和用户提示</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; let systemPrompt = "You are an AI programming assistant.";</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; let userPrompt = prompt;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; const systemMatch = prompt.match(/&lt;SYSTEM&gt;(.*?)&lt;\/SYSTEM&gt;/s);</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; if (systemMatch &amp;&amp; systemMatch[1]) {</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; systemPrompt = systemMatch[1].trim();</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; userPrompt = prompt.substring(prompt.indexOf("&lt;/SYSTEM&gt;") + 10).trim();</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; }</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; // 增强系统提示，确保返回格式正确</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; systemPrompt += "\n请确保返回完整的代码。如果是修改现有文件，请返回整个文件内容，并使用 &lt;/copilot-edited-file&gt; 标记结束。请保持代码的完整性和正确的缩进。";</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; // 创建目标 API 请求体</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; const apiRequest = {</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; model: "qwen-max-latest",</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; messages: [</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; { role: "system", content: systemPrompt },</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; &nbsp; { role: "user", content: userPrompt }</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; ],</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; temperature: requestBody.temperature || 0,</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; &nbsp; stream: true // 强制使用流式响应</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; };</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; console.log('发送到 API 的请求:', JSON.stringify(apiRequest, null, 2));</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp;&nbsp;</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; // 发送请求到目标 API</span><span leaf=""><br></span><span leaf="">&nbsp; &nbsp; const apiUrl = 'https://dashscope.aliyuncs.com/compatible-mode/v1/chat/completions';</span></code></pre><p style="margin: 1.4em 0px;"><span leaf=""><br></span></p><p style="margin: 1.4em 0px;"><span leaf="">由于 qwen-max 不太遵守原本的提示词，我特意在提示词后增加了一个中文强化：</span><i><span leaf="">请确保返回完整的代码。如果是修改现有文件，请返回整个文件内容，并使用 &lt;/copilot-edited-file&gt; 标记结束。请保持代码的完整性和正确的缩进。</span></i></p><p style="margin: 1.4em 0px;"><span leaf="">测试 Agent功能</span></p><p style="margin: 1.4em 0px;"><span leaf=""><img class="rich_pages wxw-img js_img_placeholder wx_img_placeholder"   data-src="/assets/images/wechat/mmbiz_qpic_cn_b6f5aec96935eb115653fe1f7bcbc3ea.jpeg"     src="/assets/images/wechat/mmbiz_qpic_cn_b6f5aec96935eb115653fe1f7bcbc3ea.jpeg" _width="677px" style="width: 677px !important; height: 356.052px !important;" crossorigin="anonymous" alt="图片"></span></p><figure  style="margin: 1.4em 0px;"></figure><p style="margin: 1.4em 0px;"><span leaf="">完美，可以出现类似 cursor 的那种光标效果，能够完整的利用工具调用，搜索、打开文件，实现自动编码。</span></p><p style="margin: 1.4em 0px;"><span leaf=""><br></span></p><section nodeleaf=""><div class="video-placeholder" style="margin: 20px auto; max-width: 100%; text-align: center;"><img src="/assets/images/wechat/mmbiz_qpic_cn_af93fd9f1dd4673cdf77e5865c7d544a.jpeg" alt="视频封面" style="max-width: 100%; height: auto; border-radius: 8px;"><p class="video-notice" style="margin-top: 10px; font-size: 14px; color: #888;">⚠️ 微信视频无法同步，请访问公众号查看原文</p></div></section><p><span leaf=""><br></span></p><p><span leaf=""><span textstyle="" style="font-size: 24px;font-weight: bold;">结</span></span></p><p style="margin: 1.4em 0px;"><span leaf="">至此，我们只需要把上面的 3 个请求指向任意离线、内部网络，就能实现模型安全可控，构建个人/企业版本 “cursor”。</span></p><p style="margin: 1.4em 0px;"><span leaf="">————</span></p><p style="margin: 1.4em 0px;"><span leaf="">更多后续</span></p><p style="margin: 1.4em 0px;"><span leaf="">1. 由于 vscode insiders 仍处于不稳定，更新中，代码会持续变化，后续正式的 vscode 版本发布，我们可以利用其开源代码重新打包，编译成开箱即用的稳定版本。</span></p><p style="margin: 1.4em 0px;"><span leaf="">2. 不同模型的提示词需要特别优化，比如针对qwen ，deepseek 和 sonnet 3.5 的提示词应该是有所区别，才能更好的提高 Agent 性能。</span></p><p style="margin: 1.4em 0px;"><span leaf="">3. 长期看，复用开源 vscode 的基础设施（包括AI 聊天和应用等能力），</span><b style="font-weight: 600;"><span leaf="">实现企业内部的 Copilot 扩展（针对内部模型调优提示词，以及强化 Agent策略）才是最佳策略。</span></b></p><p style="margin: 1.4em 0px 0px;"><span leaf="">4. 目前智能 IDE非常卷，但都是基于 vscode 进行分叉（已知的有cursor/windsurf/trea/viod等），这是因为 vscode 官方面对新型工具出现动作太慢导致，长期看智能 IDE 体验最终会走向平稳和趋同，分叉 vscode 的必要性会越来越低。 未来很可能是 vscode 仍提供公共的智能 IDE 能力，提供接口让扩展优化和微调自己的 LLM 策略。</span></p><p style="margin: 1.4em 0px 0px;"><span leaf=""><br></span></p><p style="margin: 1.4em 0px 0px;"><span style="color: rgb(25, 27, 31);font-family: -apple-system, &quot;system-ui&quot;, &quot;Helvetica Neue&quot;, &quot;PingFang SC&quot;, &quot;Microsoft YaHei&quot;, &quot;Source Han Sans SC&quot;, &quot;Noto Sans CJK SC&quot;, &quot;WenQuanYi Micro Hei&quot;, sans-serif;font-size: medium;font-style: normal;font-variant-ligatures: normal;font-variant-caps: normal;font-weight: 400;letter-spacing: normal;orphans: 2;text-align: start;text-indent: 0px;text-transform: none;widows: 2;word-spacing: 0px;-webkit-text-stroke-width: 0px;background-color: rgb(255, 255, 255);text-decoration-thickness: initial;text-decoration-style: initial;text-decoration-color: initial;display: inline !important;float: none;"><span leaf="">相关分享：</span></span><span leaf="">混沌随想：VSCode 二次开发指南</span></p><section style="margin-bottom: 0px;"><span leaf=""><br></span></section><p style="display: none;"><mp-style-type ></mp-style-type></p>

<hr />

<div class="original-link" style="margin-top: 20px; padding: 10px; background-color: #f8f8f8; border-radius: 6px;">
  <p style="margin: 0; font-size: 14px;">⚠️ 本文自动同步自公众号，排版可能异常，其包含图片、视频内容可能无法正常显示和播放。</p>
  <p style="margin: 5px 0 0; font-size: 14px;">原文链接：<a href="https://mp.weixin.qq.com/s/5SmF13d68LWF-LgHs5JyMA?token=1452984702&lang=zh_CN" target="_blank" rel="noopener noreferrer">点击查看微信公众号原文</a></p>
</div>
</div> <div class="copyright" style="font-style: italic;white-space: break-spaces;white-space: normal;font-size:14px;line-height: 1.5;" data-v-d56170a2>
——————<br data-v-d56170a2>
文档信息
<br data-v-d56170a2> <br data-v-d56170a2> <div data-v-d56170a2>标题：<a target="__blank" href="https://imwangfu.com/2025/03/cursor.html" data-v-d56170a2>全网首家，教你快速打造个人/企业版本 cursor</a></div> <div style="word-break: break-all;" data-v-d56170a2>发表时间：2025年3月9日</div> <div style="word-break: break-all;" data-v-d56170a2>笔名：混沌随想</div> <div style="word-break: break-all;" data-v-d56170a2>原链接：<a target="__blank" href="https://imwangfu.com/2025/03/cursor.html" data-v-d56170a2>https://imwangfu.com/2025/03/cursor.html</a></div> <div style="word-break: break-all;" data-v-d56170a2>版权声明：如需转载，请邮件知会 imwangfu@gmail.com，并保留此文档信息申明</div> <br data-v-d56170a2> <div style="word-break: break-all;" data-v-d56170a2>更多深度随想可以关注公众号：混沌随想</div>
——————
    </div> <div class="wx-qrcode" data-v-d56170a2><img src="/left.png" alt style="width:36%" data-v-d56170a2> <img src="/right.png" alt style="width:64%" data-v-d56170a2></div> <div class="page-edit" data-v-d56170a2><!----> <div class="last-updated" data-v-d56170a2><span class="prefix" data-v-d56170a2>更新时间: </span> <time datetime="1758120940000" class="time" data-v-d56170a2>2025年9月17日, 14:55:40</time></div></div> <!---->  <div id="gitalk-container" data-v-d56170a2></div></div> <div id="disqus_thread" class="blog" data-v-d56170a2></div></div> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.32403bab.js" defer></script><script src="/assets/js/3.8dc51a7a.js" defer></script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-TWXMJ6R199"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-TWXMJ6R199");
    </script>
    <script>
      var _hmt = _hmt || [];
      (function () {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?088b745d5fe1e425c919ebcf4f27bc46";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
  </body>
</html>
